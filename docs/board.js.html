<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: board.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: board.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Loads tasks from Firebase and updates the HTML UI.
 * @async
 * @function
 */
async function loadTasksFromFirebase() {
  try {
    const response = await fetch(
      "https://join-store-ae38e-default-rtdb.europe-west1.firebasedatabase.app/task.json"
    );
    if (!response.ok) {
      throw new Error("Network response was not ok");
    }
    const data = await response.json();
    if (data &amp;&amp; Object.keys(data).length > 0) {
      updateHTML(data);
    } else {
      console.warn("No tasks found.");
    }
  } catch (error) {
    console.error("Error loading tasks:", error);
  }
}

/**
 * Gets the value of the search input field and converts it to lowercase.
 * @param {string} selector - The CSS selector of the search input element.
 * @returns {string} The lowercase value of the search input.
 */
function getSearchInput(selector) {
  const input = document.querySelector(selector);
  return input ? input.value.toLowerCase() : "";
}

/**
 * Filters tasks in a specific category based on the search input.
 * @param {string} containerId - The ID of the container element.
 * @param {string} searchInput - The search input string to filter tasks by.
 */
function filterTasksInCategory(containerId, searchInput) {
  const container = document.getElementById(containerId);
  if (!container) {
    console.warn(`Container with ID '${containerId}' not found.`);
    return;
  }

  const tasks = container.querySelectorAll(".boardTaskCard");

  tasks.forEach((task) => {
    const taskTitle = task
      .querySelector(".boardCardTitle")
      ?.textContent.toLowerCase();
    const taskDescription = task
      .querySelector(".boardCardDescription")
      ?.textContent.toLowerCase();

    if (
      taskTitle?.includes(searchInput) ||
      taskDescription?.includes(searchInput)
    ) {
      task.style.display = "";
    } else {
      task.style.display = "none";
    }
  });
}

/**
 * Filters tasks in all categories based on the search input.
 * @param {Array&lt;string>} categories - Array of category IDs to filter tasks in.
 * @param {string} searchInput - The search input string to filter tasks by.
 */
function filterTasksInAllCategories(categories, searchInput) {
  categories.forEach((category) => {
    filterTasksInCategory(category, searchInput);
  });
}

/**
 * Filters tasks based on the search input across all columns.
 */
function filterTasks() {
  const searchInput = getSearchInput(".searchinput");
  const categories = [
    "todoColumn",
    "inprogressColumn",
    "awaitfeedbackColumn",
    "doneColumn",
  ];
  filterTasksInAllCategories(categories, searchInput);
}

let currentDraggedElement;

/**
 * Starts dragging a task element.
 * @param {Event} event - The drag event.
 * @param {string} id - The ID of the task element being dragged.
 */
function dragStart(event, id) {
  currentDraggedElement = document.querySelector(`#${id}`);
  event.dataTransfer.setData("text", id);
  event.target.style.opacity = "0.5";
}

/**
 * Ends dragging a task element.
 * @param {Event} event - The drag event.
 */
function dragEnd(event) {
  event.target.style.opacity = "1";
}

/**
 * Allows dropping of elements during drag-and-drop.
 * @param {Event} event - The drop event.
 */
function allowDrop(event) {
  event.preventDefault();
}

/**
 * Retrieves the target column element for a task.
 * @param {string} category - The ID of the target column.
 * @returns {Element|null} The target column element or null if not found.
 */
function getTargetColumn(category) {
  const targetColumn = document.getElementById(category);
  if (!targetColumn) {
    console.error("Invalid target column:", category);
  }
  return targetColumn;
}

/**
 * Maps a column ID to its corresponding progress status.
 * @param {string} category - The ID of the category (column).
 * @returns {string|null} The corresponding progress status or null if invalid.
 */
function getNewProgress(category) {
  const progressMapping = {
    todoColumn: "todo",
    inprogressColumn: "inprogress",
    awaitfeedbackColumn: "awaitfeedback",
    doneColumn: "done",
  };

  const newProgress = progressMapping[category];
  if (!newProgress) {
    console.error("Invalid category:", category);
  }
  return newProgress;
}

/**
 * Moves an element (task) to the specified column.
 * @param {Element} targetColumn - The target column element.
 * @param {Element} element - The task element to move.
 */
function moveElementToColumn(targetColumn, element) {
  targetColumn.appendChild(element);
}

/**
 * Updates the progress of a task in Firebase.
 * @param {string} taskId - The ID of the task to update.
 * @param {string} newProgress - The new progress status of the task.
 * @async
 */
async function updateTaskProgress(taskId, newProgress) {
  const existingTaskData = await getTaskData(taskId);
  if (existingTaskData) {
    await updateTaskProgressInFirebase(taskId, newProgress, existingTaskData);
    console.log(
      `Task ${taskId} successfully moved to category ${newProgress}.`
    );
  } else {
    console.error(`No data found for task ${taskId}.`);
  }
}

/**
 * Moves a task to a new column and updates its progress.
 * @param {string} category - The ID of the target category (column).
 * @param {Event} event - The drop event.
 * @async
 */
async function moveTo(category, event) {
  event.preventDefault();
  if (!currentDraggedElement) return;

  const targetColumn = getTargetColumn(category);
  if (!targetColumn) return;

  moveElementToColumn(targetColumn, currentDraggedElement);

  const taskId = currentDraggedElement.id;
  const newProgress = getNewProgress(category);
  if (!newProgress) return;

  await updateTaskProgress(taskId, newProgress);
}

/**
 * Fetches task data from Firebase using the task ID.
 * @param {string} taskId - The ID of the task.
 * @returns {Object|null} The task data or null if not found.
 * @async
 */
async function getTaskData(taskId) {
  try {
    const response = await fetch(
      `https://join-store-ae38e-default-rtdb.europe-west1.firebasedatabase.app/task/${taskId}.json`
    );
    if (response.ok) {
      return await response.json();
    } else {
      return null;
    }
  } catch (error) {
    return null;
  }
}

/**
 * Prepares the updated task data with the new progress.
 * @param {Object} existingTaskData - The existing task data.
 * @param {string} newProgress - The new progress status of the task.
 * @returns {Object} The updated task data.
 */
function prepareUpdatedTaskData(existingTaskData, newProgress) {
  return {
    ...existingTaskData,
    progress: newProgress,
  };
}

/**
 * Sends a request to Firebase to update the task data.
 * @param {string} taskId - The ID of the task to update.
 * @param {Object} updatedTaskData - The updated task data.
 * @returns {Promise&lt;Response>} The response from the Firebase request.
 * @async
 */
async function sendUpdateRequestToFirebase(taskId, updatedTaskData) {
  const url = `https://join-store-ae38e-default-rtdb.europe-west1.firebasedatabase.app/task/${taskId}.json`;

  try {
    const response = await fetch(url, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(updatedTaskData),
    });

    return response;
  } catch (error) {
    console.error("Error sending request to Firebase:", error);
    throw error;
  }
}

/**
 * Handles the response from Firebase after updating a task's progress.
 * @param {Response} response - The response object from the Firebase request.
 * @param {string} taskId - The ID of the task.
 * @param {string} newProgress - The new progress status of the task.
 */
function handleFirebaseResponse(response, taskId, newProgress) {
  if (response.ok) {
    console.log(
      `Task ${taskId} progress successfully updated to ${newProgress}.`
    );
  } else {
    console.error("Error updating progress in Firebase.");
  }
}

/**
 * Updates the task progress in Firebase after preparing the updated data.
 * @param {string} taskId - The ID of the task to update.
 * @param {string} newProgress - The new progress status of the task.
 * @param {Object} existingTaskData - The existing task data.
 * @async
 */
async function updateTaskProgressInFirebase(
  taskId,
  newProgress,
  existingTaskData
) {
  try {
    const updatedTaskData = prepareUpdatedTaskData(
      existingTaskData,
      newProgress
    );
    const response = await sendUpdateRequestToFirebase(taskId, updatedTaskData);
    handleFirebaseResponse(response, taskId, newProgress);
  } catch (error) {
    console.error("Error updating task in Firebase:", error);
  }
  updateEmptyColumnMessages();
}

/**
 * Highlights the target column when a task is being dragged over it.
 * @param {string} status - The status of the target column.
 * @param {Event} event - The drag event.
 */
function highlightColumn(status, event) {
  const column = document.getElementById(`${status}Column`);
  if (column) {
    column.classList.add("drag-area-highlight");
  }
}

/**
 * Removes the highlight from the target column after dragging ends.
 * @param {string} status - The status of the target column.
 */
function removeHighlight(status) {
  const column = document.getElementById(`${status}Column`);
  if (column) {
    column.classList.remove("drag-area-highlight");
  }
}

/**
 * Initializes the application by including necessary HTML and loading tasks from Firebase.
 */
window.onload = () => {
  includeHTML();
  loadTasksFromFirebase();
};

/**
 * Shows the overlay to add a new task.
 */
function showOverlayAddTask() {
  let template = document.getElementById("add-task-template");
  template.classList.remove("dNone");
  template.innerHTML += addTaskTemplate();
  setupDropdownEvents();
  loadContacts();
  onlyToDay();
}

/**
 * Sets the "min" attribute of the task date input field to today.
 */
function onlyToDay() {
  const today = new Date().toISOString().split("T")[0];
  document.getElementById("addTaskDate").setAttribute("min", today);
}

/**
 * Sets up event listeners for dropdown menu interactions.
 */
function setupDropdownEvents() {
  const dropDownHeader = document.getElementById("dropDownHeaderId");
  const dropDownBody = document.getElementById("dropDownBodyId");
  const dropDownArrow = dropDownHeader?.querySelector("img");

  dropDownHeader.addEventListener("click", () => {
    dropDownBody.classList.toggle("dNone");

    if (!dropDownBody.classList.contains("dNone")) {
      dropDownArrow.style.transform = "rotate(180deg)";
    } else {
      dropDownArrow.style.transform = "rotate(0deg)";
    }
  });
}

/**
 * Hides the overlay to add a new task.
 */
function hideOverlayAddTask() {
  let template = document.getElementById("add-task-template");
  template.innerHTML = "";
  template.classList.add("dNone");
  checked = [];
  subtasks = [];
}

/**
 * Shows the overlay with the task info card.
 */
function showOverlayInfoCard() {
  const overlay = document.getElementById("overlay");
  const card = document.getElementById("taskInfoCard");
  overlay.style.display = "block";
  card.classList.add("showCard");
  overlay.addEventListener("click", closeOverlayInfoCard);
}

/**
 * Hides the task info card overlay.
 */
function hideOverlayInfoCard() {
  const overlay = document.getElementById("overlay");
  const card = document.getElementById("taskInfoCard");
  overlay.style.display = "none";
  card.classList.remove("showCard");
  card.classList.add("hideCard");
  setTimeout(() => {
    card.classList.remove("hideCard");
  }, 500);

  const searchInputElement = document.querySelector(".searchinput");
  if (searchInputElement) {
    searchInputElement.value = "";
  }
  const categories = [
    "todoColumn",
    "inprogressColumn",
    "awaitfeedbackColumn",
    "doneColumn",
  ];
  categories.forEach((category) => {
    const container = document.getElementById(category);
    if (container) {
      const tasks = container.querySelectorAll(".boardTaskCard");
      tasks.forEach((task) => {
        task.style.display = ""; // Make all tasks visible again
      });
    }
  });
  checked = [];
}

/**
 * Closes the task info card overlay and resets task data.
 */
function closeOverlayInfoCard() {
  hideOverlayInfoCard();
  taskInit();
  const card = document.getElementById("taskInfoCard");
  card.innerHTML = "";
}

/**
 * Hides the list card that displays a list of tasks.
 */
function hideshowListCard() {
  document.getElementById("showListCard").classList.add("dNone");
}

let subtasksEditCard = [];

/**
 * Adds a new subtask to the current task being edited.
 */
function addEditSubTask() {
  if (!currentTask.task.subtask) {
    currentTask.task.subtask = [];
  }
  subtasksEditCard = currentTask.task.subtask;
  let inputText = document.getElementById("inputSubTask");
  if (inputText.value &amp;&amp; subtasksEditCard.length &lt;= 1) {
    subtasksEditCard.push(inputText.value);
  }
  rendEditSubTask(currentTask);
  hideEditAddBtn();
}

/**
 * Renders the subtasks of the current task being edited.
 * @param {Object} task The task object containing subtasks.
 */
function rendEditSubTask(task) {
  subtasks = task.task.subtask;
  let toRender = document.getElementById("renderSubTask2");
  toRender.innerHTML = "";
  if (subtasks) {
    subtasks.forEach((subtask, index) => {
      toRender.innerHTML += rendEditSubTaskHtml(subtask, index);
    });
  }
}

/**
 * Deletes a subtask from the current task being edited.
 * @param {number} index The index of the subtask to delete.
 */
function deleteEditTask(index) {
  subtasks.splice(index, 1);
  rendEditSubTask({ task: { subtask: subtasks } });
}

/**
 * Adds an event listener to update or delete a subtask when clicking the button.
 * @param {number} index The index of the subtask to edit.
 */
function addEditSubTaskcheck(index) {
  let btn = document.getElementById(`AddSubTaskStep2-${index}`);
  let inputText = document.getElementById(`toEditInputSubTask-${index}`);
  btn.addEventListener("click", () => {
    if (inputText.value) {
      subtasks[index] = inputText.value;
      rendEditSubTask({ task: { subtask: subtasks } });
    } else {
      deleteEditTask(index);
    }
  });
}

/**
 * Updates the task data in Firebase.
 * @param {string} task The task ID to update.
 * @returns {Promise&lt;Object>} The updated task data from Firebase.
 */
async function updateTaskOnFireBase(task) {
  let taskData = getValue(task);
  try {
    const response = await fetch(`${BASE_URL}/task/${task}.json`, {
      method: "PUT", // PUT for updating
      body: JSON.stringify({
        title: taskData.title,
        description: taskData.description,
        assignet: taskData.assignet,
        date: taskData.date,
        prio: taskData.prio,
        category: taskData.category,
        subtask: taskData.subtask,
        progress: taskData.progress,
      }),
      headers: { "Content-Type": "application/json" },
    });
    if (!response.ok) {
      throw new Error("Error saving contact data");
    }
    const updatedContact = await response.json();
    return updatedContact;
  } catch (error) {
    console.error("Error updating the contact:", error);
    throw error;
  }
}

/**
 * Initializes the task update process in Firebase and lists the updated task.
 * @param {string} task The task ID to update.
 */
async function toDoForUpdateTaskOnFireBase(task) {
  await updateTaskOnFireBase(task);
  await taskInit();
  listDataCard(task);
}

/**
 * Retrieves the current values of the task being edited.
 * @param {string} taskid The task ID to get values for.
 * @returns {Object} The task data.
 */
function getValue(taskid) {
  const task = tasks.find((t) => t.id === taskid);
  if (!task) return;
  const newAssignet =
    checked &amp;&amp; checked.length > 0 ? checked : task.task.assignet;
  title = document.getElementById("addTaskTittle").value;
  description = document.getElementById("addTaskDescription").value;
  assignet = checked;
  date = document.getElementById("addTaskDate").value;
  prio = getPriorityValue();
  subtask = subtasks;
  progress = task.task.progress;
  category = task.task.category;

  return {
    title,
    description,
    assignet: newAssignet,
    date,
    prio,
    subtask,
    progress,
    category,
  };
}

/**
 * Initializes the task loading process.
 * @async
 */
async function taskInit() {
  await loadContactss();
}

/**
 * Fetches all contacts from the given path.
 * @async
 * @param {string} path - The path to append to the base URL.
 * @returns {Promise&lt;Object>} The JSON response containing contacts.
 */
async function getAllContacts(path = "") {
  let response = await fetch(`${BASE_URL}` + path + ".json");
  return (responseJs = await response.json());
}

let tasks = [];

/**
 * Loads task data from the server and stores it in the tasks array.
 * @async
 * @returns {Promise&lt;Array>} The list of tasks.
 */
async function loadTaskData() {
  let ContactResponse = await getAllContacts("task");
  let UserKeyArray = Object.keys(ContactResponse);
  tasks = UserKeyArray.map((id) => ({
    id: id,
    task: ContactResponse[id],
  }));
  return tasks;
}

/**
 * Loads contacts and categorizes tasks into columns.
 * @async
 */
async function loadContactss() {
  let tasksData = await loadTaskData(); // Retrieve task data
  let todoId = document.getElementById("todoColumn");
  let awaitfeedbackId = document.getElementById("awaitfeedbackColumn");
  let inprogressId = document.getElementById("inprogressColumn");
  let doneId = document.getElementById("doneColumn");

  // Clear columns
  todoId.innerHTML = "";
  awaitfeedbackId.innerHTML = "";
  inprogressId.innerHTML = "";
  doneId.innerHTML = "";

  tasksData.forEach((task) => {
    // Assign tasks to respective columns
    if (task.task.progress === "todo") {
      todoId.innerHTML += renderCard(task);
    } else if (task.task.progress === "awaitfeedback") {
      awaitfeedbackId.innerHTML += renderCard(task);
    } else if (task.task.progress === "inprogress") {
      inprogressId.innerHTML += renderCard(task);
    } else if (task.task.progress === "done") {
      doneId.innerHTML += renderCard(task);
    }
  });

  // Update messages for empty columns
  updateEmptyColumnMessages(tasksData);

  // Show assigned persons
  tasksData.forEach((task) => {
    showAssignet(task);
  });
}

/**
 * Updates the empty column messages if any column is empty.
 * @param {Array} tasksData - The array of tasks to check for content.
 */
function updateEmptyColumnMessages(tasksData) {
  const columns = [
    { columnId: "todoColumn", messageClass: "no-tasks-message" },
    { columnId: "awaitfeedbackColumn", messageClass: "no-tasks-message" },
    { columnId: "inprogressColumn", messageClass: "no-tasks-message" },
    { columnId: "doneColumn", messageClass: "no-tasks-message" },
  ];

  columns.forEach(({ columnId, messageClass }) => {
    const column = document.getElementById(columnId);
    const messageDiv = column
      .closest(".column")
      .querySelector(`.${messageClass}`);

    if (!column.innerHTML.trim()) {
      messageDiv.style.display = "flex";
    } else {
      messageDiv.style.display = "none";
    }
  });
}

/**
 * Converts the task category number into a human-readable string.
 * @param {Object} task - The task object.
 * @returns {string} The category name.
 */
function fromNumberToName(task) {
  let categoryName;
  if (task.task.category == 1) {
    categoryName = "Technical Task";
  } else if (task.task.category == 2) {
    categoryName = "User Story";
  }
  return categoryName;
}

/**
 * Truncates text to a specific length and adds ellipsis if needed.
 * @param {string} text - The text to truncate.
 * @param {number} maxLength - The maximum length of the text.
 * @returns {string} The truncated text with ellipsis.
 */
function truncateText(text, maxLength) {
  if (!text || typeof text !== "string") {
    return "";
  }
  if (text.length > maxLength) {
    return text.substring(0, maxLength) + "...";
  }
  return text;
}

/**
 * Renders a task card for the board.
 * @param {Object} task - The task object to render.
 * @returns {string} The HTML string for the task card.
 */
function renderCard(task) {
  const maxTitleLength = 30;
  const maxDescriptionLength = 35;
  const truncatedTitle = truncateText(task.task.title, maxTitleLength);
  const truncatedDescription = truncateText(
    task.task.description,
    maxDescriptionLength
  );

  return `
      &lt;div 
        class="boardTaskCard" 
        id="${task.id}" 
        draggable="true" 
        ondragstart="dragStart(event, '${task.id}')"
        ondragend="dragEnd(event)"
        onclick="listDataCard('${task.id}')"
      >
        &lt;div 
          id="Category${task.task.category}" 
          class="boardCategoryCard cat${task.task.category}">
          ${fromNumberToName(task)}
        &lt;/div>
        &lt;div>
          &lt;h3 class="boardCardTitle">${truncatedTitle}&lt;/h3>
          &lt;p class="boardCardDescription">${truncatedDescription}&lt;/p>
        &lt;/div>
        &lt;div class="progresBar">
              &lt;div class="progress-container">
                  &lt;div class="progress-bar${showSubTasks(task)}">
                  &lt;/div>
              &lt;/div>
          &lt;div style="font-size: 12px;">${showSubTasks(task)} /2 Subtasks&lt;/div>
        &lt;/div>
        &lt;div class="assignetPersonContainer">
          &lt;div id="asigned${task.id}" class="assignetPersonCard">&lt;/div>
          &lt;div>${showPrioIcon(task)}&lt;/div>
        &lt;/div>
      &lt;/div>`;
}

/**
 * Shows the number of subtasks for a task.
 * @param {Object} task - The task object to check for subtasks.
 * @returns {string|number} The number of subtasks or "0" if none exist.
 */
function showSubTasks(task) {
  if (task.task.subtask &amp;&amp; task.task.subtask.length > 0) {
    return task.task.subtask.length;
  } else {
    return "0";
  }
}

/**
 * Shows assigned persons for a task.
 * @param {Object} task - The task object with assigned persons.
 */
function showAssignet(task) {
  let asignedDiv = document.getElementById(`asigned${task.id}`);
  if (!asignedDiv) {
    return;
  }
  asignedDiv.innerHTML = "";
  let assigned = task.task.assignet;
  if (!assigned || assigned.length === 0) {
    return;
  }
  assigned.forEach((person) => {
    let initials = person.name
      .split(" ")
      .map((word) => word[0].toUpperCase())
      .join("")
      .slice(0, 2);
    let color = getColorForInitial(initials[0]);
    asignedDiv.innerHTML += `
        &lt;div id="${person.key}" class="assignetPersonKreis" style="background-color: ${color};">
          ${initials}
        &lt;/div>
      `;
  });
}

/**
 * Returns a color code based on the initial of a name.
 * @param {string} initial - The initial of a person's name.
 * @returns {string} The corresponding color code.
 */
function getColorForInitial(initial) {
  const colors = {
    A: "#FF5733",
    B: "#FFBD33",
    C: "#DBFF33",
    D: "#75FF33",
    E: "#33FF57",
    F: "#33FFBD",
    G: "#3399FF",
    H: "#8A2BE2",
    I: "#5733FF",
    J: "#BD33FF",
    K: "#FF33DB",
    L: "#FF3375",
    M: "#FF3333",
    N: "#FF6633",
    O: "#FF9933",
    P: "#FFCC33",
    Q: "#FFFF33",
    R: "#CCFF33",
    S: "#66CC33",
    T: "#66FF33",
    U: "#33FF66",
    V: "#33FF99",
    W: "#33FFCC",
    X: "#33FFFF",
    Y: "#33CCFF",
    Z: "#3399FF",
  };
  return colors[initial] || "#333333";
}

/**
 * Displays a priority icon for a task.
 * @param {Object} task - The task object containing priority info.
 * @returns {string} The HTML string for the priority icon.
 */
function showPrioIcon(task) {
  let prio = task.task.prio;
  let iconPath;
  if (prio == "low") {
    iconPath = "./assets/priority/prioCard/lowCard.svg";
  } else if (prio == "medium") {
    iconPath = "./assets/priority/prioCard/mediumCard.svg";
  } else if (prio == "urgent") {
    iconPath = "./assets/priority/prioCard/urgentCard.svg";
  }
  return `&lt;img src="${iconPath}" alt="${prio} priority icon" style="width:20px; height:20px;">`;
}

/**
 * Deletes a task by its ID.
 * @async
 * @param {string} contactId - The ID of the task to delete.
 */
async function deleteTask(contactId) {
  try {
    const response = await fetch(`${BASE_URL}/task/${contactId}.json`, {
      method: "DELETE",
    });
    if (!response.ok) {
      throw new Error("Fehler beim LÃ¶schen des Kontakts");
    }
    taskInit();
    hideOverlayInfoCard();
  } catch (error) {}
}

/**
 * Edits the task data card and displays it in the edit mode.
 * @param {string} taskId - The ID of the task to edit.
 */
function editListDataCard(taskId) {
  const task = tasks.find((t) => t.id === taskId);
  currentTask = task;
  if (!task) return;
  let cardRender = document.getElementById("taskInfoCard");
  cardRender.innerHTML = "";
  cardRender.innerHTML += showEditCard(task);
  showAssignet(task);
  setupDropdownEvents();
  rendEditSubTask(task);
  loadContactsForEdit();
  onlyToDay();
}

/**
 * Displays the task info card in the view mode.
 * @param {string} taskId - The ID of the task to display.
 */
function listDataCard(taskId) {
  const task = tasks.find((t) => t.id === taskId);
  if (!task) return;
  showOverlayInfoCard();
  let cardRender = document.getElementById("taskInfoCard");
  cardRender.innerHTML = "";
  cardRender.innerHTML += showInfoCard(task);
  showInfoAssignet(task);
  showSubTasksString(task);
}

/**
 * Capitalizes the first letter of a string.
 * @param {string} text - The text to capitalize.
 * @returns {string} The capitalized string.
 */
function capitalizeFirstLetter(text) {
  if (!text) return "";
  return text.charAt(0).toUpperCase() + text.slice(1).toLowerCase();
}

/**
 * Displays the list of subtasks for a task.
 * @param {Object} task - The task object containing subtasks.
 */
function showSubTasksString(task) {
  let subtasks = task.task.subtask;
  let subtasklist = document.getElementById("subtaskList");
  subtasklist.innerHTML = "";
  if (subtasks &amp;&amp; subtasks.length > 0) {
    subtasks.forEach((subtask) => {
      subtasklist.innerHTML += `
          &lt;div class="subtaskItem">
              &lt;img src="./assets/subtask/checkbox.svg" alt="" class="cursor" onclick="toggleImage(this)"  id="checkbox" />${subtask}
          &lt;/div>`;
    });
  } else {
    subtasklist.innerHTML = "&lt;p>No subtasks available.&lt;/p>";
  }
}

/**
 * Toggles the checkbox image between checked and unchecked states.
 * @param {HTMLElement} imageElement - The image element to toggle.
 */
function toggleImage(imageElement) {
  const checkedSrc = "checkbox-checked.svg";
  const uncheckedSrc = "checkbox.svg";
  const currentSrc = imageElement.src.split("/").pop();
  if (currentSrc === uncheckedSrc) {
    imageElement.src = "./assets/subtask/" + checkedSrc;
  } else {
    imageElement.src = "./assets/subtask/" + uncheckedSrc;
  }
}

/**
 * Displays assigned persons for the task in the info card.
 * @param {Object} task - The task object containing assigned persons.
 */
function showInfoAssignet(task) {
  let asignedDiv = document.getElementById(`asignedd${task.id}`);
  if (!asignedDiv) {
    return;
  }
  asignedDiv.innerHTML = "";
  let assigned = task.task.assignet;
  if (!assigned || assigned.length === 0) {
    return;
  }
  assigned.forEach((person) => {
    let initials = person.name
      .split(" ")
      .map((word) => word[0].toUpperCase())
      .join("")
      .slice(0, 2);
    let color = getColorForInitial(initials[0]);
    asignedDiv.innerHTML += `
        &lt;div class="dflex" style="gap:16px;">
                  &lt;div id="${person.key}" class="assignetPersonKreis" style="background-color: ${color};">
            ${initials}
          &lt;/div>
          &lt;span>${person.name}&lt;/span>
        &lt;/div>
      `;
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#BASE_URL">BASE_URL</a></li><li><a href="global.html#addConfirmationButtons">addConfirmationButtons</a></li><li><a href="global.html#addContact">addContact</a></li><li><a href="global.html#addDataToFireBase">addDataToFireBase</a></li><li><a href="global.html#addDataToFireBaseFromBoard">addDataToFireBaseFromBoard</a></li><li><a href="global.html#addEditSubTask">addEditSubTask</a></li><li><a href="global.html#addEditSubTaskcheck">addEditSubTaskcheck</a></li><li><a href="global.html#addEditcheck">addEditcheck</a></li><li><a href="global.html#addEvent">addEvent</a></li><li><a href="global.html#addLetterHeader">addLetterHeader</a></li><li><a href="global.html#addSilverline">addSilverline</a></li><li><a href="global.html#addSubTask">addSubTask</a></li><li><a href="global.html#allowDrop">allowDrop</a></li><li><a href="global.html#attemptLogin">attemptLogin</a></li><li><a href="global.html#backToLogin">backToLogin</a></li><li><a href="global.html#backgroundEdit">backgroundEdit</a></li><li><a href="global.html#capitalizeFirstLetter">capitalizeFirstLetter</a></li><li><a href="global.html#changeEditWithCheck">changeEditWithCheck</a></li><li><a href="global.html#clearErrors">clearErrors</a></li><li><a href="global.html#clearLoginData">clearLoginData</a></li><li><a href="global.html#closeOverlay">closeOverlay</a></li><li><a href="global.html#closeOverlayInfoCard">closeOverlayInfoCard</a></li><li><a href="global.html#createContactCard">createContactCard</a></li><li><a href="global.html#createContactElement">createContactElement</a></li><li><a href="global.html#createErrorMessages">createErrorMessages</a></li><li><a href="global.html#createInitialsBadge">createInitialsBadge</a></li><li><a href="global.html#createUserObject">createUserObject</a></li><li><a href="global.html#currentUser">currentUser</a></li><li><a href="global.html#deleteContact">deleteContact</a></li><li><a href="global.html#deleteContactFromApi">deleteContactFromApi</a></li><li><a href="global.html#deleteEditTask">deleteEditTask</a></li><li><a href="global.html#deleteInputSubTask">deleteInputSubTask</a></li><li><a href="global.html#deleteSubTask">deleteSubTask</a></li><li><a href="global.html#deleteTask">deleteTask</a></li><li><a href="global.html#displayContactOverlay">displayContactOverlay</a></li><li><a href="global.html#displayContacts">displayContacts</a></li><li><a href="global.html#dragEnd">dragEnd</a></li><li><a href="global.html#dragStart">dragStart</a></li><li><a href="global.html#editAddedSubTask">editAddedSubTask</a></li><li><a href="global.html#editContact">editContact</a></li><li><a href="global.html#editListDataCard">editListDataCard</a></li><li><a href="global.html#fetchAndFillContactData">fetchAndFillContactData</a></li><li><a href="global.html#fetchContactsData">fetchContactsData</a></li><li><a href="global.html#fetchUsers">fetchUsers</a></li><li><a href="global.html#filterTasks">filterTasks</a></li><li><a href="global.html#filterTasksInAllCategories">filterTasksInAllCategories</a></li><li><a href="global.html#filterTasksInCategory">filterTasksInCategory</a></li><li><a href="global.html#findUser">findUser</a></li><li><a href="global.html#fromNumberToName">fromNumberToName</a></li><li><a href="global.html#gatherContactData">gatherContactData</a></li><li><a href="global.html#generateInitials">generateInitials</a></li><li><a href="global.html#getAllContacts">getAllContacts</a></li><li><a href="global.html#getColorForInitial">getColorForInitial</a></li><li><a href="global.html#getCurrentUser">getCurrentUser</a></li><li><a href="global.html#getFormData">getFormData</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getLoginInput">getLoginInput</a></li><li><a href="global.html#getNewProgress">getNewProgress</a></li><li><a href="global.html#getPriorityValue">getPriorityValue</a></li><li><a href="global.html#getSearchInput">getSearchInput</a></li><li><a href="global.html#getSignUpInputs">getSignUpInputs</a></li><li><a href="global.html#getTargetColumn">getTargetColumn</a></li><li><a href="global.html#getTaskData">getTaskData</a></li><li><a href="global.html#getValue">getValue</a></li><li><a href="global.html#getValueFromInputs">getValueFromInputs</a></li><li><a href="global.html#handleCardClick">handleCardClick</a></li><li><a href="global.html#handleClickOutsideOverlay">handleClickOutsideOverlay</a></li><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#handleFailedLogin">handleFailedLogin</a></li><li><a href="global.html#handleFirebaseResponse">handleFirebaseResponse</a></li><li><a href="global.html#handleFormSubmit">handleFormSubmit</a></li><li><a href="global.html#handleGuestLoginClick">handleGuestLoginClick</a></li><li><a href="global.html#handleLoginClick">handleLoginClick</a></li><li><a href="global.html#handleNetworkError">handleNetworkError</a></li><li><a href="global.html#handleSignUp">handleSignUp</a></li><li><a href="global.html#handleSubmit">handleSubmit</a></li><li><a href="global.html#handleSuccess">handleSuccess</a></li><li><a href="global.html#handleSuccessfulLogin">handleSuccessfulLogin</a></li><li><a href="global.html#handleUserConfirmation">handleUserConfirmation</a></li><li><a href="global.html#hideEditAddBtn">hideEditAddBtn</a></li><li><a href="global.html#hideErrorContainer">hideErrorContainer</a></li><li><a href="global.html#hideOverlayAddTask">hideOverlayAddTask</a></li><li><a href="global.html#hideOverlayInfoCard">hideOverlayInfoCard</a></li><li><a href="global.html#hideSecondOverlay">hideSecondOverlay</a></li><li><a href="global.html#hideSubTaskAddBtn">hideSubTaskAddBtn</a></li><li><a href="global.html#hideToast">hideToast</a></li><li><a href="global.html#hideshowListCard">hideshowListCard</a></li><li><a href="global.html#highlightColumn">highlightColumn</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initializeBlurValidation">initializeBlurValidation</a></li><li><a href="global.html#insertInitialsIntoElement">insertInitialsIntoElement</a></li><li><a href="global.html#insertUserName">insertUserName</a></li><li><a href="global.html#isInvalidInput">isInvalidInput</a></li><li><a href="global.html#isInvalidLoginInput">isInvalidLoginInput</a></li><li><a href="global.html#listDataCard">listDataCard</a></li><li><a href="global.html#loadContacts">loadContacts</a></li><li><a href="global.html#loadContactsData">loadContactsData</a></li><li><a href="global.html#loadContactsForEdit">loadContactsForEdit</a></li><li><a href="global.html#loadContactss">loadContactss</a></li><li><a href="global.html#loadTaskData">loadTaskData</a></li><li><a href="global.html#loadTasksFromFirebase">loadTasksFromFirebase</a></li><li><a href="global.html#loadUserDataFromSession">loadUserDataFromSession</a></li><li><a href="global.html#moveElementToColumn">moveElementToColumn</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#onLoginSuccess">onLoginSuccess</a></li><li><a href="global.html#onlyToDay">onlyToDay</a></li><li><a href="global.html#openContactOverlay">openContactOverlay</a></li><li><a href="global.html#openOverlay">openOverlay</a></li><li><a href="global.html#overlayListeners">overlayListeners</a></li><li><a href="global.html#prefillLoginData">prefillLoginData</a></li><li><a href="global.html#prepareUpdatedTaskData">prepareUpdatedTaskData</a></li><li><a href="global.html#processSignUp">processSignUp</a></li><li><a href="global.html#pushUserToDatabase">pushUserToDatabase</a></li><li><a href="global.html#redirectToHome">redirectToHome</a></li><li><a href="global.html#redirectToHomeSSummary">redirectToHomeSSummary</a></li><li><a href="global.html#redirectToSummary">redirectToSummary</a></li><li><a href="global.html#removeHighlight">removeHighlight</a></li><li><a href="global.html#rendEditSubTask">rendEditSubTask</a></li><li><a href="global.html#rendSubTask">rendSubTask</a></li><li><a href="global.html#renderCard">renderCard</a></li><li><a href="global.html#renderContacts">renderContacts</a></li><li><a href="global.html#renderSortedContacts">renderSortedContacts</a></li><li><a href="global.html#requiredValidation">requiredValidation</a></li><li><a href="global.html#requiredValidationAddTaskToBoard">requiredValidationAddTaskToBoard</a></li><li><a href="global.html#resetErrorStates">resetErrorStates</a></li><li><a href="global.html#resetForm">resetForm</a></li><li><a href="global.html#resetFormErrors">resetFormErrors</a></li><li><a href="global.html#saveCurrentUser">saveCurrentUser</a></li><li><a href="global.html#saveLoginData">saveLoginData</a></li><li><a href="global.html#sendContactData">sendContactData</a></li><li><a href="global.html#sendUpdateRequestToFirebase">sendUpdateRequestToFirebase</a></li><li><a href="global.html#setActiveContact">setActiveContact</a></li><li><a href="global.html#setUserInitials">setUserInitials</a></li><li><a href="global.html#setUserInitialss">setUserInitialss</a></li><li><a href="global.html#setupDropdownEvents">setupDropdownEvents</a></li><li><a href="global.html#showAssignet">showAssignet</a></li><li><a href="global.html#showConfirmationToast">showConfirmationToast</a></li><li><a href="global.html#showDeletionSuccessToast">showDeletionSuccessToast</a></li><li><a href="global.html#showError">showError</a></li><li><a href="global.html#showErrorContainer">showErrorContainer</a></li><li><a href="global.html#showInfoAssignet">showInfoAssignet</a></li><li><a href="global.html#showOverlayAddTask">showOverlayAddTask</a></li><li><a href="global.html#showOverlayInfoCard">showOverlayInfoCard</a></li><li><a href="global.html#showPasswordError">showPasswordError</a></li><li><a href="global.html#showPopupAndRedirect">showPopupAndRedirect</a></li><li><a href="global.html#showPrioIcon">showPrioIcon</a></li><li><a href="global.html#showSignUpPopup">showSignUpPopup</a></li><li><a href="global.html#showSubTasks">showSubTasks</a></li><li><a href="global.html#showSubTasksString">showSubTasksString</a></li><li><a href="global.html#showToastMessage">showToastMessage</a></li><li><a href="global.html#sortContacts">sortContacts</a></li><li><a href="global.html#startEvent">startEvent</a></li><li><a href="global.html#storeUserInLocalStorage">storeUserInLocalStorage</a></li><li><a href="global.html#storeUserInSession">storeUserInSession</a></li><li><a href="global.html#storeUserInSessionStorage">storeUserInSessionStorage</a></li><li><a href="global.html#subtasktrigger">subtasktrigger</a></li><li><a href="global.html#taskInit">taskInit</a></li><li><a href="global.html#toDoForUpdateTaskOnFireBase">toDoForUpdateTaskOnFireBase</a></li><li><a href="global.html#toggleDropdown">toggleDropdown</a></li><li><a href="global.html#toggleImage">toggleImage</a></li><li><a href="global.html#togglePassword">togglePassword</a></li><li><a href="global.html#truncateText">truncateText</a></li><li><a href="global.html#updateContactOnServer">updateContactOnServer</a></li><li><a href="global.html#updateEmptyColumnMessages">updateEmptyColumnMessages</a></li><li><a href="global.html#updateSecondOverlay">updateSecondOverlay</a></li><li><a href="global.html#updateTaskOnFireBase">updateTaskOnFireBase</a></li><li><a href="global.html#updateTaskProgress">updateTaskProgress</a></li><li><a href="global.html#updateTaskProgressInFirebase">updateTaskProgressInFirebase</a></li><li><a href="global.html#uploadToFireBase">uploadToFireBase</a></li><li><a href="global.html#validateContactData">validateContactData</a></li><li><a href="global.html#validateEmail">validateEmail</a></li><li><a href="global.html#validateField">validateField</a></li><li><a href="global.html#validateForm">validateForm</a></li><li><a href="global.html#validateFormData">validateFormData</a></li><li><a href="global.html#validateInputs">validateInputs</a></li><li><a href="global.html#validateName">validateName</a></li><li><a href="global.html#validatePasswords">validatePasswords</a></li><li><a href="global.html#validateSignUpInputs">validateSignUpInputs</a></li><li><a href="global.html#validateUser">validateUser</a></li><li><a href="global.html#variableId">variableId</a></li><li><a href="global.html#whenChecked">whenChecked</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Wed Jan 01 2025 20:28:28 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
